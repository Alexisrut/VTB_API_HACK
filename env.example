# ====================================================================
# FastAPI Authentication & Authorization System
# Пример конфигурационного файла
# ====================================================================

# -------- DATABASE --------
# PostgreSQL асинхронное подключение
# Формат: postgresql+asyncpg://user:password@host:port/database
DATABASE_URL=postgresql+asyncpg://fastapi_user:fastapi_password@localhost:5434/fastapi_db

# Redis для кэширования и сессий
REDIS_URL=redis://localhost:6381/0

# -------- JWT SETTINGS --------
# Секретный ключ для подписи JWT токенов
# Минимум 32 символа, используйте: python -c "import secrets; print(secrets.token_urlsafe(32))"
SECRET_KEY=your-super-secret-key-minimum-32-characters-long-generate-it-securely

# Алгоритм подписи JWT
ALGORITHM=HS256

# Время жизни access токена в минутах
ACCESS_TOKEN_EXPIRE_MINUTES=15

# Время жизни refresh токена в днях
REFRESH_TOKEN_EXPIRE_DAYS=7

# -------- SMS SERVICE --------
# Выбор провайдера SMS
# Опции: sms_ru, twilio, aws_sns, sendpulse
SMS_SERVICE_PROVIDER=sms_ru

# API ключ для SMS сервиса
# Получите на https://sms.ru или у выбранного провайдера
SMS_API_KEY=your_sms_api_key_here

# Имя отправителя для SMS (максимум 11 символов)
SMS_FROM_NAME=YourApp

# Максимальное количество попыток ввода SMS кода
SMS_MAX_ATTEMPTS=3

# Время действия SMS кода в минутах
SMS_CODE_EXPIRY_MINUTES=10

# -------- OAUTH2 / OPENID CONNECT --------
# URL банковского API (согласно ФАПИ Банка России)
BANK_API_URL=https://vbank.open.bankingapi.ru

# Client ID от банка для OAuth2
BANK_CLIENT_ID=your_bank_client_id_here

# Client Secret от банка для OAuth2
BANK_CLIENT_SECRET=your_bank_client_secret_here

# Redirect URI для OAuth2 callback
# Должен совпадать с зарегистрированным в банке
BANK_REDIRECT_URI=http://localhost:8000/auth/oauth/callback

# Scope для доступа к банковским данным
# Опции: openid, profile, accounts, transactions, payments
BANK_SCOPES=openid profile accounts

# -------- BANK API CONFIGURATION --------
# Конфигурация для трёх банков: Virtual Bank, Awesome Bank, Smart Bank
# Эти значения используются для получения bank-token и работы с API

# Virtual Bank (vbank)
VBANK_API_URL=https://vbank.open.bankingapi.ru
VBANK_CLIENT_ID=team261-1
VBANK_CLIENT_SECRET=your_vbank_client_secret_here
VBANK_REQUESTING_BANK=team261
VBANK_REQUESTING_BANK_NAME=Team 261 Virtual Bank App
VBANK_REDIRECTING_URL=https://vbank.open.bankingapi.ru/client/

# Awesome Bank (abank)
ABANK_API_URL=https://abank.open.bankingapi.ru
ABANK_CLIENT_ID=team261-1
ABANK_CLIENT_SECRET=your_abank_client_secret_here
ABANK_REQUESTING_BANK=team261
ABANK_REQUESTING_BANK_NAME=Team 261 Awesome Bank App
ABANK_REDIRECTING_URL=https://abank.open.bankingapi.ru/client/

# Smart Bank (sbank)
SBANK_API_URL=https://sbank.open.bankingapi.ru
SBANK_CLIENT_ID=team261-1
SBANK_CLIENT_SECRET=your_sbank_client_secret_here
SBANK_REQUESTING_BANK=team261
SBANK_REQUESTING_BANK_NAME=Team 261 Smart Bank App
SBANK_REDIRECTING_URL=https://sbank.open.bankingapi.ru/client/

# -------- EMAIL SETTINGS --------
# SMTP сервер для отправки email
SMTP_SERVER=smtp.gmail.com

# Порт SMTP
SMTP_PORT=587

# Email адрес отправителя
SMTP_USER=your_email@gmail.com

# Пароль приложения Gmail (не основной пароль!)
# Используйте: https://myaccount.google.com/apppasswords
SMTP_PASSWORD=your_app_password_here

# Email для отправки писем с подтверждением
FROM_EMAIL=noreply@yourapp.com

# -------- APPLICATION SETTINGS --------
# Frontend URL для перенаправлений
FRONTEND_URL=http://localhost:3000

# Окружение приложения (development, staging, production)
ENVIRONMENT=development

# Режим отладки (включает более подробные логи)
DEBUG=True

# -------- SECURITY --------
# Требовать HTTPS в production
REQUIRE_HTTPS=False  # Установите True в production

# CORS разрешенные домены (comma-separated)
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8080,http://127.0.0.1:3000

# -------- LOGGING --------
# Уровень логирования (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# Директория для логов
LOG_DIR=./logs

# -------- RATE LIMITING --------
# Включить rate limiting
RATE_LIMITING_ENABLED=True

# Максимум запросов в минуту для анонимных пользователей
RATE_LIMIT_REQUESTS_PER_MINUTE=60

# Максимум запросов в минуту для авторизованных пользователей
RATE_LIMIT_REQUESTS_PER_MINUTE_AUTHENTICATED=100

# -------- MONITORING --------
# Включить Prometheus метрики
PROMETHEUS_ENABLED=False

# -------- OPTIONAL SETTINGS --------
# Максимальный размер запроса в MB
MAX_REQUEST_SIZE=10

# Таймаут для подключения к внешним сервисам (секунды)
EXTERNAL_SERVICE_TIMEOUT=30

# Количество рабочих процессов Uvicorn
WORKERS=4

# ====================================================================
# ИНСТРУКЦИИ ПО ПОЛУЧЕНИЮ ЗНАЧЕНИЙ
# ====================================================================

# 1. SECRET_KEY:
#    python -c "import secrets; print(secrets.token_urlsafe(32))"

# 2. SMS_API_KEY (sms.ru):
#    - Перейти на https://sms.ru
#    - Зарегистрироваться
#    - Получить API ID в личном кабинете
#    - Добавить номер в доверенные

# 3. BANK_CLIENT_ID и BANK_CLIENT_SECRET:
#    - Обратиться к банку (Sbank, Vbank, и т.д.)
#    - Получить учетные данные OAuth2
#    - Согласовать redirect_uri

# 4. SMTP_PASSWORD (Gmail):
#    - Перейти на https://myaccount.google.com/apppasswords
#    - Выбрать приложение "Mail" и устройство "Windows/Mac/Linux"
#    - Скопировать сгенерированный пароль

# 5. BANK_REDIRECT_URI:
#    - В development: http://localhost:8000/auth/oauth/callback
#    - В production: https://yourdomain.com/auth/oauth/callback

# ====================================================================
# ПРИМЕРЫ ИСПОЛЬЗОВАНИЯ
# ====================================================================

# Для разработки используйте:
# DATABASE_URL=postgresql+asyncpg://user:password@localhost:5432/fastapi_dev
# DEBUG=True
# ENVIRONMENT=development

# Для staging используйте:
# DATABASE_URL=postgresql+asyncpg://user:password@staging-db:5432/fastapi_staging
# DEBUG=False
# ENVIRONMENT=staging
# REQUIRE_HTTPS=True

# Для production используйте:
# DATABASE_URL=postgresql+asyncpg://user:password@prod-db:5432/fastapi_prod
# DEBUG=False
# ENVIRONMENT=production
# REQUIRE_HTTPS=True
# RATE_LIMITING_ENABLED=True
# PROMETHEUS_ENABLED=True

# ====================================================================
# БЕЗОПАСНОСТЬ
# ====================================================================

# ⚠️ НИКОГДА не коммитьте этот файл в git, если в нем реальные значения!
# Используйте: git update-index --assume-unchanged .env

# ✅ Рекомендуемые настройки для .gitignore:
# .env
# .env.local
# .env.*.local
# .env.production

# ✅ Для разработки скопируйте этот файл:
# cp .env.example .env

# ✅ Для production используйте переменные окружения системы:
# export SECRET_KEY=your-secret-key
# export DATABASE_URL=postgresql+asyncpg://...

# ====================================================================
